# ููุฒุฉ ุงููุดุฑ ุงูุชููุงุฆู ุงูููุฑู ููุดุงุญูุงุช ุงููุงุฑุบุฉ

**ุงูุชุงุฑูุฎ**: 29 ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ**: 2.0  
**ุงูุญุงูุฉ**: ูุทุจู โ

---

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุฌุฏูุฏ ูููุดุฑ ุงูุชููุงุฆู ุงูููุฑู ูุฅุนูุงูุงุช ุงูุดุงุญูุงุช ุงููุงุฑุบุฉุ ุจุญูุซ ูุชู ูุดุฑ ุงูุฅุนูุงูุงุช ุชููุงุฆูุงู ููุฑ ุชููุฑ ุดุงุญูุฉ ูุงุฑุบุฉุ ูุน ุฅุนุงุฏุฉ ูุดุฑ ุชููุงุฆูุฉ ุจุนุฏ ููู ุฃู ููููู ุฅุฐุง ูู ูุชู ุญุฌุฒ ุงูุดุงุญูุฉ.

### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ

**ุฅุนูุงูุงุช ุงูุดุงุญูุงุช ุงููุงุฑุบุฉ = ุงูุชุฑููุฌ ุงูุฃุณุงุณู ููุดุฑูุฉ**

ูู ุชุนุฏ ููุงู ุญุงุฌุฉ ูููุฒุฉ "ุชุฑููุฌ ุงูุฃุณุทูู" ุงููููุตูุฉ. ุงูุขูุ ูุดุฑ ุฅุนูุงูุงุช ุงูุดุงุญูุงุช ุงููุงุฑุบุฉ ูู ุงูุทุฑููุฉ ุงูุฃุณุงุณูุฉ ููุชุฑููุฌ ููุดุฑูุฉ ูุฌุฐุจ ุงูุนููุงุก.

---

## ููู ูุนูู ุงููุธุงูุ

### 1. ุงููุดุฑ ุงูููุฑู ุนูุฏ ุงูุชููุฑ

ุนูุฏูุง ุชุชุบูุฑ ุญุงูุฉ ุดุงุญูุฉ ูู "ูู ุงูุนูู" ุฅูู "ูุชุงุญ"ุ ูุญุฏุซ ุงูุชุงูู ุชููุงุฆูุงู:

1. ูุชู ุชูุนูู Mongoose hook ุนูู ูููุฐุฌ Vehicle
2. ูุชู ุงูุชุญูู ูู ุฃู ุงูุดุฑูุฉ ูุฏููุง ููุฒุฉ ุงููุดุฑ ุงูุชููุงุฆู ููุนูุฉ
3. ูุชู ุชูููุฏ ูุญุชูู ูุตู ูุจุชูุฑ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
4. ูุชู ุชูููุฏ ุตูุฑุฉ ุงุญุชุฑุงููุฉ ููุดุงุญูุฉ ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
5. ูุชู ูุดุฑ ุงูุฅุนูุงู ููุฑุงู ุนูู ุงูููุตุฉ
6. ูุชู ุชุณุฌูู ููุช ุงููุดุฑ ูู ุญูู `lastAutoPostedAt`

**ูุง ุญุงุฌุฉ ูุงูุชุธุงุฑ ุงูุชูููุช ุงููุฌุฏูู!**

### 2. ุฅุนุงุฏุฉ ุงููุดุฑ ุงูุชููุงุฆู

ูุนูู ูุฌุฏูู ุฎุงุต ูู 6 ุณุงุนุงุช ููุจุญุซ ุนู ุดุงุญูุงุช ูุงุฑุบุฉ ุชุญุชุงุฌ ุฅุนุงุฏุฉ ูุดุฑ:

**ุงูุดุฑูุท**:
- ุงูุดุงุญูุฉ ูุง ุชุฒุงู ูู ุญุงูุฉ "ูุชุงุญ"
- ูุฑ ุนูู ุขุฎุฑ ูุดุฑ 24-48 ุณุงุนุฉ
- ุงูุดุฑูุฉ ูุฏููุง ููุฒุฉ ุงููุดุฑ ุงูุชููุงุฆู ููุนูุฉ

**ุงูุฅุฌุฑุงุก**:
- ูุชู ุฅุนุงุฏุฉ ูุดุฑ ุฅุนูุงู ุฌุฏูุฏ ุจูุญุชูู ูุฎุชูู
- ูุชู ุชุญุฏูุซ `lastAutoPostedAt` ุจุงูููุช ุงูุฌุฏูุฏ
- ูุชู ุฒูุงุฏุฉ ุนุฏุงุฏ `autoPostCount`

### 3. ุงูููุดูุฑุงุช ุงูุนุงุฏูุฉ ุชุจูู ูุฌุฏููุฉ

ุงูููุฒุงุช ุงูุชุงููุฉ ุชุจูู ุนูู ุงูุชูููุช ุงููุฌุฏูู ููุง ูู:
- **ุงูุฑุณุงุฆู ุงูุชููุงุฆูุฉ** (Auto Messaging)
- **ุงูุชูุงุฑูุฑ ุงูุฃุณุจูุนูุฉ** (Weekly Reports)

---

## ุงูุชุนุฏููุงุช ุงูุชูููุฉ ุงููุทุจูุฉ

### 1. ูููุฐุฌ Vehicle (models/Vehicle.js)

**ุญููู ุฌุฏูุฏุฉ**:
```javascript
lastAutoPostedAt: {
  type: Date,
  default: null,
}
autoPostCount: {
  type: Number,
  default: 0,
}
```

**Mongoose Hooks**:
- `post('save')`: ููุดุฑ ุฅุนูุงู ุนูุฏ ุฅูุดุงุก ุฃู ุชุญุฏูุซ ุดุงุญูุฉ ุจุญุงูุฉ "ูุชุงุญ"
- `post('findOneAndUpdate')`: ููุดุฑ ุฅุนูุงู ุนูุฏ ุชุญุฏูุซ ุญุงูุฉ ุดุงุญูุฉ ุฅูู "ูุชุงุญ"

### 2. ูููุฐุฌ Post (models/Post.js)

**ุญููู ุฌุฏูุฏุฉ**:
```javascript
aiFeatureType: {
  enum: ['auto_posting', 'fleet_promotion', 'auto_posting_instant', null],
}
relatedVehicle: {
  type: mongoose.Schema.Types.ObjectId,
  ref: 'Vehicle',
}
```

### 3. ููู ุฌุฏูุฏ: utils/autoPostEmptyTruck.js

**ุงููุธููุฉ ุงูุฑุฆูุณูุฉ**: `autoPostSingleEmptyTruck(vehicleId)`

**ุงููุณุคูููุงุช**:
- ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุดุฑูุฉ
- ููุน ุงูุชูุฑุงุฑ (ูุง ููุดุฑ ุฅุฐุง ุชู ุงููุดุฑ ุฎูุงู ุงูุณุงุนุฉ ุงูุฃุฎูุฑุฉ)
- ุชูููุฏ ูุญุชูู ูุชููุน ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู
- ุชูููุฏ ุตูุฑุฉ ุงุญุชุฑุงููุฉ
- ุฅูุดุงุก ุงูููุดูุฑ
- ุชุญุฏูุซ ูุนูููุงุช ุงููุดุฑ ูู ุงููุฑูุจุฉ

### 4. ููู ุฌุฏูุฏ: utils/repostEmptyTrucksScheduler.js

**ุงููุธููุฉ ุงูุฑุฆูุณูุฉ**: `startRepostEmptyTrucksScheduler()`

**ุงูุฌุฏููุฉ**: ูู 6 ุณุงุนุงุช (Cron: `0 */6 * * *`)

**ุงููุณุคูููุงุช**:
- ุงูุจุญุซ ุนู ุดุงุญูุงุช ูุงุฑุบุฉ ูู ูุชู ูุดุฑูุง ููุฐ 24-48 ุณุงุนุฉ
- ุฅุนุงุฏุฉ ูุดุฑ ุฅุนูุงูุงุช ุฌุฏูุฏุฉ ููุง
- ุชุณุฌูู ุงููุชุงุฆุฌ ูู ุงูู logs

### 5. ุชุนุฏูู utils/aiService.js

**ุงูุชุบููุฑ ุงูุฑุฆูุณู**:
- `autoPosting` ูู ูุนุฏ ูุนูู ูู ุฎูุงู `runAIFeaturesForUser`
- ูุชู ุงูุขู ุฅุฑุฌุงุน ุฑุณุงูุฉ ุชูุถุญ ุฃู ุงููุดุฑ ูุนูู ุชููุงุฆูุงู
- `fleetPromotion` ุชู ุฏูุฌู ูุน `autoPosting`

### 6. ุชุนุฏูู server.js

**ุฅุถุงูุฉ**:
```javascript
const { startRepostEmptyTrucksScheduler } = require('./utils/repostEmptyTrucksScheduler');
startRepostEmptyTrucksScheduler();
```

---

## ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุงูุณููุงุฑูู 1: ุดุงุญูุฉ ุชูุชูู ูู ุฑุญูุฉ

**ุงููุถุน**:
- ุงูุณุงุนุฉ 10:00 ุตุจุงุญุงู: ุดุงุญูุฉ ูู ุญุงูุฉ "ูู ุงูุนูู"
- ุงูุณุงุนุฉ 11:30 ุตุจุงุญุงู: ุชูุชูู ุงูุฑุญูุฉุ ุงูุณุงุฆู ูุบูุฑ ุงูุญุงูุฉ ุฅูู "ูุชุงุญ"

**ูุง ูุญุฏุซ**:
- ููุฑุงู ุนูุฏ ุงูุณุงุนุฉ 11:30 ุตุจุงุญุงูุ ูุชู ูุดุฑ ุฅุนูุงู ุชููุงุฆูุงู
- ูุง ุญุงุฌุฉ ูุงูุชุธุงุฑ ุงูููุช ุงููุฌุฏูู

### ุงูุณููุงุฑูู 2: ุดุงุญูุฉ ูุงุฑุบุฉ ูู ูุฃุชู ููุง ุฃุญุฏ

**ุงููุถุน**:
- ุงูููู ุงูุฃููุ ุงูุณุงุนุฉ 11:30 ุตุจุงุญุงู: ูุดุฑ ุฅุนูุงู ููุดุงุญูุฉ
- ุงูููู ุงูุซุงููุ ุงูุณุงุนุฉ 11:30 ุตุจุงุญุงู: ุงูุดุงุญูุฉ ูุง ุชุฒุงู ูุงุฑุบุฉ

**ูุง ูุญุฏุซ**:
- ุงููุฌุฏูู ูุนูู ูู 6 ุณุงุนุงุช ููุชุญูู
- ุนูุฏ ุงูุณุงุนุฉ 12:00 ุธูุฑุงู (ุจุนุฏ 24.5 ุณุงุนุฉ)ุ ูุชู ุฅุนุงุฏุฉ ูุดุฑ ุฅุนูุงู ุฌุฏูุฏ
- ุฅุฐุง ุจููุช ูุงุฑุบุฉุ ุณูุชู ุฅุนุงุฏุฉ ุงููุดุฑ ูุฑุฉ ุฃุฎุฑู ุจุนุฏ 24-48 ุณุงุนุฉ

### ุงูุณููุงุฑูู 3: ุดุฑูุฉ ูุฏููุง 10 ุดุงุญูุงุช

**ุงููุถุน**:
- ุงูุณุงุนุฉ 9:00 ุตุจุงุญุงู: ุฌููุน ุงูุดุงุญูุงุช ูู ุงูุนูู
- ุงูุณุงุนุฉ 10:00 ุตุจุงุญุงู: ุดุงุญูุฉ ูุงุญุฏุฉ ุฃุตุจุญุช ูุงุฑุบุฉ โ ูุดุฑ ุฅุนูุงู ููุฑุงู
- ุงูุณุงุนุฉ 11:00 ุตุจุงุญุงู: ุดุงุญูุชุงู ุฃุตุจุญุชุง ูุงุฑุบุชูู โ ูุดุฑ ุฅุนูุงููู ููุฑุงู
- ุงูุณุงุนุฉ 2:00 ูุณุงุกู: 3 ุดุงุญูุงุช ุฃุฎุฑู ุฃุตุจุญุช ูุงุฑุบุฉ โ ูุดุฑ 3 ุฅุนูุงูุงุช ููุฑุงู

**ุงููุชูุฌุฉ**: 6 ุฅุนูุงูุงุช ุชู ูุดุฑูุง ุชููุงุฆูุงู ูู ุฃููุงุช ูุฎุชููุฉ ุญุณุจ ุงูุชููุฑ

---

## ุงูููุงุฆุฏ

### ููุดุฑูุงุช

**ุงุณุชุฌุงุจุฉ ููุฑูุฉ**: ูุง ุญุงุฌุฉ ูุงูุชุธุงุฑ ุงูููุช ุงููุฌุฏููุ ุงูุฅุนูุงูุงุช ุชูุดุฑ ููุฑ ุงูุชููุฑ.

**ุฒูุงุฏุฉ ุงููุฑุต**: ูู ุดุงุญูุฉ ูุงุฑุบุฉ ุชุญุตู ุนูู ูุฑุตุฉ ููุฑูุฉ ููุญุฌุฒ.

**ุชุฑููุฌ ูุณุชูุฑ**: ุฅุนุงุฏุฉ ุงููุดุฑ ุงูุชููุงุฆู ุชุถูู ุจูุงุก ุงูุดุงุญูุงุช ูู ุงููุงุฌูุฉ.

**ุชูููุฑ ุงูููุช**: ูุง ุญุงุฌุฉ ูููุดุฑ ุงููุฏูู ุฃู ุถุจุท ุงูุชูููุชุงุช.

### ููุนููุงุก

**ูุนูููุงุช ุญุฏูุซุฉ**: ูุฑูู ุดุงุญูุงุช ูุชุงุญุฉ ูุนููุงู ูููุณุช ูุฏููุฉ.

**ุฎูุงุฑุงุช ุฃูุซุฑ**: ุฅุนูุงูุงุช ูุชุนุฏุฏุฉ ูู ุฃููุงุช ูุฎุชููุฉ ุชุนูู ุฎูุงุฑุงุช ุฃูุซุฑ.

**ุงุณุชุฌุงุจุฉ ุณุฑูุนุฉ**: ูููููู ุญุฌุฒ ุดุงุญูุฉ ููุฑ ุชููุฑูุง.

---

## ุงูุฅุนุฏุงุฏุงุช ุงููุทููุจุฉ

### ููุดุฑูุงุช

ูุชูุนูู ูุฐู ุงูููุฒุฉุ ูุฌุจ ุนูู ุงูุดุฑูุฉ:

1. ุชูุนูู ููุฒุฉ "ุงููุดุฑ ุงูุชููุงุฆู" ูู ุฅุนุฏุงุฏุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู
2. ูุง ุญุงุฌุฉ ูุถุจุท ุชูููุช ูุญุฏุฏ (ูุนูู ุชููุงุฆูุงู)
3. ุงูุชุฃูุฏ ูู ุชุญุฏูุซ ุญุงูุฉ ุงูุดุงุญูุงุช ุจุงูุชุธุงู

### ูู ุงูููุฏ

```javascript
user.aiFeatures.autoPosting = true;
```

---

## ุงูุงุฎุชูุงูุงุช ุนู ุงููุธุงู ุงููุฏูู

| ุงูููุฒุฉ | ุงููุธุงู ุงููุฏูู | ุงููุธุงู ุงูุฌุฏูุฏ |
|--------|---------------|---------------|
| **ุชูููุช ุงููุดุฑ** | ูุฌุฏูู (ูุซูุงู 9:00 ุตุจุงุญุงู) | ููุฑู ุนูุฏ ุงูุชููุฑ |
| **ุงูุชุฑููุฌ ููุฃุณุทูู** | ููุฒุฉ ูููุตูุฉ | ูุฏูุฌ ูุน ุฅุนูุงูุงุช ุงูุดุงุญูุงุช |
| **ุฅุนุงุฏุฉ ุงููุดุฑ** | ูุฏูู | ุชููุงุฆู ูู 24-48 ุณุงุนุฉ |
| **ุงูุงุณุชุฌุงุจุฉ** | ุจุทูุฆุฉ (ูุฏ ุชูุชุธุฑ 24 ุณุงุนุฉ) | ููุฑูุฉ (ุซูุงูู) |
| **ุงููุฑููุฉ** | ูุญุฏูุฏุฉ | ุนุงููุฉ ุฌุฏุงู |

---

## ุงููููุงุช ุงููุนุฏูุฉ

1. `models/Vehicle.js` - ุฅุถุงูุฉ ุญููู ูhooks
2. `models/Post.js` - ุฅุถุงูุฉ ููุน ุฌุฏูุฏ ูุญูู relatedVehicle
3. `utils/autoPostEmptyTruck.js` - ููู ุฌุฏูุฏ
4. `utils/repostEmptyTrucksScheduler.js` - ููู ุฌุฏูุฏ
5. `utils/aiService.js` - ุชุนุฏูู runAIFeaturesForUser
6. `server.js` - ุฅุถุงูุฉ ุงููุฌุฏูู ุงูุฌุฏูุฏ
7. `utils/imageGenerator.js` - ุชุญุณูู ุชูููุฏ ุงูุตูุฑ (ูู ุงูุชุญุฏูุซ ุงูุณุงุจู)

---

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงููุดุฑ ุงูููุฑู

1. ุฅูุดุงุก ุดุงุญูุฉ ุฌุฏูุฏุฉ ุจุญุงูุฉ "ูู ุงูุนูู"
2. ุชุบููุฑ ุญุงูุชูุง ุฅูู "ูุชุงุญ"
3. ุงูุชุญูู ูู ูุดุฑ ุฅุนูุงู ููุฑุงู

### ุงุฎุชุจุงุฑ ุฅุนุงุฏุฉ ุงููุดุฑ

1. ุฅูุดุงุก ุดุงุญูุฉ ุจุญุงูุฉ "ูุชุงุญ" ููุดุฑ ุฅุนูุงู ููุง
2. ุงูุงูุชุธุงุฑ 24 ุณุงุนุฉ (ุฃู ุชุนุฏูู ุงูููุช ููุงุฎุชุจุงุฑ)
3. ุงูุชุญูู ูู ุฅุนุงุฏุฉ ุงููุดุฑ ุงูุชููุงุฆู

### ุงุฎุชุจุงุฑ ููุน ุงูุชูุฑุงุฑ

1. ุชุบููุฑ ุญุงูุฉ ุดุงุญูุฉ ุฅูู "ูุชุงุญ"
2. ูุญุงููุฉ ุชุบููุฑ ุญุงูุชูุง ูุฑุฉ ุฃุฎุฑู ุฎูุงู ุณุงุนุฉ
3. ุงูุชุญูู ูู ุนุฏู ูุดุฑ ุฅุนูุงู ููุฑุฑ

---

## ุงูุตูุงูุฉ ูุงููุฑุงูุจุฉ

### Logs ุงููููุฉ

```
๐ Auto posting for empty truck: [ุงุณู ุงูุดุงุญูุฉ] ([ุฑูู ุงูููุญุฉ])
โ Successfully posted for empty truck: [ุงุณู ุงูุดุงุญูุฉ]
๐ Reposting for truck: [ุงุณู ุงูุดุงุญูุฉ] ([ุฑูู ุงูููุญุฉ])
```

### ุงููุฑุงูุจุฉ ุงูููุตู ุจูุง

- ุนุฏุฏ ุงูุฅุนูุงูุงุช ุงูููุดูุฑุฉ ุชููุงุฆูุงู ููููุงู
- ุนุฏุฏ ุฅุนุงุฏุงุช ุงููุดุฑ
- ูุนุฏู ูุฌุงุญ ุงููุดุฑ
- ุงูุดุงุญูุงุช ุงูุชู ูู ูุชู ูุดุฑ ุฅุนูุงูุงุช ููุง

---

## ุงูุฎูุงุตุฉ

ูุฐุง ุงููุธุงู ุงูุฌุฏูุฏ ูุญูู ุฅุนูุงูุงุช ุงูุดุงุญูุงุช ุงููุงุฑุบุฉ ูู ููุฒุฉ ูุฌุฏููุฉ ุฅูู ูุธุงู ุฐูู ููุณุชุฌูุจ ูุนูู ูู ุงูููุช ุงููุนููุ ููุง ูุฒูุฏ ูู ูุฑุต ุงูุดุฑูุงุช ูู ุงูุญุตูู ุนูู ุนููุงุก ููููุฑ ููุนููุงุก ูุนูููุงุช ุฏูููุฉ ูุญุฏูุซุฉ.
