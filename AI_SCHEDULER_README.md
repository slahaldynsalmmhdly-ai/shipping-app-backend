# ุฌุฏููุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุชููุงุฆูุฉ - AI Scheduler

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ุฌุฏููุฉ ุชููุงุฆู ูุชุดุบูู ููุฒุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุจุดูู ูููู ุฏูู ุงูุญุงุฌุฉ ููุชุดุบูู ุงููุฏูู.

---

## โฐ ุงูุฌุฏูู ุงูุฒููู

### ุงูููุช ุงูุงูุชุฑุงุถู:
**ูู ููู ุงูุณุงุนุฉ 9:00 ุตุจุงุญุงู** (ุจุชูููุช ุงูุณุนูุฏูุฉ - GMT+3)

### ูุงุฐุง ูุญุฏุซ ุชููุงุฆูุงูุ
1. ุงููุธุงู ูุจุญุซ ุนู ุฌููุน ุงูุดุฑูุงุช ุงูุชู ูุฏููุง ููุฒุงุช AI ููุนูุฉ
2. ูุดุบู ุงูููุฒุงุช ุงูููุนูุฉ ููู ุดุฑูุฉ:
   - โ ุงููุดุฑ ุงูุชููุงุฆู ููุดุงุญูุงุช ุงููุงุฑุบุฉ
   - โ ุงููุฑุงุณูุฉ ุงูุชููุงุฆูุฉ ููุนููุงุก ุงููุญุชูููู
   - โ ุงูุชุฑููุฌ ููุฃุณุทูู (ูุน ุตูุฑ ุงูุฃุณุทูู ูุงูุดุงุญูุงุช)
   - โ ุงูุชูุงุฑูุฑ ุงูุฃุณุจูุนูุฉ
3. ูุณุฌู ุงููุชุงุฆุฌ ูู console logs

---

## ๐ ุงูุชุดุบูู

### ุงูุชุดุบูู ุงูุชููุงุฆู:
ุงูุฌุฏููุฉ ุชุจุฏุฃ ุชููุงุฆูุงู ุนูุฏ ุชุดุบูู ุงูุฎุงุฏู:
```bash
npm start
```

ุณุชุธูุฑ ุฑุณุงูุฉ:
```
โฐ AI Scheduler initialized - Will run daily at 9:00 AM (Saudi Arabia time)
```

### ุงูุชุญูู ูู ุนูู ุงูุฌุฏููุฉ:
ุฑุงูุจ console logs ูู ููู ุงูุณุงุนุฉ 9 ุตุจุงุญุงูุ ุณุชุธูุฑ:
```
๐ค [AI Scheduler] Starting daily AI features execution at [ุงูุชุงุฑูุฎ ูุงูููุช]
๐ข Found X companies with AI features enabled
โถ๏ธ  Running AI features for: [ุงุณู ุงูุดุฑูุฉ]
   โ Auto Posting: ุชู ุฅูุดุงุก 3 ููุดูุฑุงุช ุจูุฌุงุญ
   โ Fleet Promotion: ุชู ุฅูุดุงุก ููุดูุฑ ุชุฑููุฌู ุจูุฌุงุญ
โ [AI Scheduler] Completed: X successful, 0 errors
```

---

## ๐ง ุชุฎุตูุต ุงูููุช

### ูุชุบููุฑ ููุช ุงูุชุดุบูู:

ุงูุชุญ ููู `utils/aiScheduler.js` ูุนุฏูู ุงูุณุทุฑ:

```javascript
// ุงูููุช ุงูุญุงูู: ูู ููู ุงูุณุงุนุฉ 9:00 ุตุจุงุญุงู
cron.schedule('0 0 9 * * *', async () => {
```

### ุฃูุซูุฉ ุนูู ุฃููุงุช ูุฎุชููุฉ:

```javascript
// ูู ููู ุงูุณุงุนุฉ 6:00 ุตุจุงุญุงู
cron.schedule('0 0 6 * * *', async () => {

// ูู ููู ุงูุณุงุนุฉ 12:00 ุธูุฑุงู
cron.schedule('0 0 12 * * *', async () => {

// ูู ููู ุงูุณุงุนุฉ 6:00 ูุณุงุกู
cron.schedule('0 0 18 * * *', async () => {

// ูุฑุชูู ููููุงู: 9 ุตุจุงุญุงู ู 6 ูุณุงุกู
cron.schedule('0 0 9,18 * * *', async () => {

// ูู 6 ุณุงุนุงุช
cron.schedule('0 0 */6 * * *', async () => {

// ูู ููู ุฃุญุฏ ุงูุณุงุนุฉ 9 ุตุจุงุญุงู ููุท
cron.schedule('0 0 9 * * 0', async () => {

// ูู ุงูุฅุซููู ุฅูู ุงูุฌูุนุฉ ุงูุณุงุนุฉ 9 ุตุจุงุญุงู
cron.schedule('0 0 9 * * 1-5', async () => {
```

### ุดุฑุญ ุตูุบุฉ Cron:
```
* * * * * *
โ โ โ โ โ โ
โ โ โ โ โ โโโโ ููู ุงูุฃุณุจูุน (0-6) (0 = ุงูุฃุญุฏ)
โ โ โ โ โโโโโโ ุงูุดูุฑ (1-12)
โ โ โ โโโโโโโโ ุงูููู ูู ุงูุดูุฑ (1-31)
โ โ โโโโโโโโโโ ุงูุณุงุนุฉ (0-23)
โ โโโโโโโโโโโโ ุงูุฏูููุฉ (0-59)
โโโโโโโโโโโโโโ ุงูุซุงููุฉ (0-59)
```

---

## ๐ ุงูุชุญุณููุงุช ุงููุถุงูุฉ

### 1. ูุดุฑ ุตูุฑ ุงูุฃุณุทูู ุชููุงุฆูุงู โ

ุนูุฏ ุชุดุบูู ููุฒุฉ "ุงูุชุฑููุฌ ููุฃุณุทูู"ุ ุงููุธุงู ุงูุขู:
- โ ูุฌูุน ุตูุฑ ุงูุฃุณุทูู ูู ููู ุงูุดุฑูุฉ (`fleetImages`)
- โ ูุถูู ุตูุฑ ุงูุดุงุญูุงุช ุงููุฑุฏูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุฎุชุงุฑ ุญุชู 5 ุตูุฑ ููู ููุดูุฑ
- โ ููุดุฑ ุงูููุดูุฑ ูุน ุงููุต ุงูุชุฑููุฌู + ุงูุตูุฑ

### 2. ุณุฌูุงุช ููุตูุฉ (Detailed Logs)

ูู ุนูููุฉ ุชุณุฌู:
- ุนุฏุฏ ุงูุดุฑูุงุช ุงููุณุชูุฏูุฉ
- ูุชูุฌุฉ ูู ููุฒุฉ ููู ุดุฑูุฉ
- ุนุฏุฏ ุงูููุดูุฑุงุช/ุงูุฑุณุงุฆู ุงููููุดุฃุฉ
- ุงูุฃุฎุทุงุก ุฅู ูุฌุฏุช

---

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูุฌุฏููุฉ ูุง ุชุนูู

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุซุจูุช `node-cron`:
   ```bash
   npm install node-cron
   ```
2. ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู:
   ```bash
   npm restart
   ```
3. ุชุญูู ูู console logs ุนูุฏ ุจุฏุก ุงูุชุดุบูู

### ุงููุดููุฉ: ูุง ูุชู ุงููุดุฑ ุฑุบู ุงูุฌุฏููุฉ

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชูุนูู ุงูููุฒุงุช ูู ุฅุนุฏุงุฏุงุช ุงูุดุฑูุฉ
2. ุชุญูู ูู ูุฌูุฏ `DEEPSEEK_API_KEY` ูู `.env`
3. ุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช ุงูุฃุณุทูู (ุดุงุญูุงุชุ ุตูุฑ)
4. ุฑุงุฌุน console logs ููุฃุฎุทุงุก

### ุงููุดููุฉ: ุงูููุช ุบูุฑ ุตุญูุญ

**ุงูุญู:**
ุชุฃูุฏ ูู ุถุจุท ุงูููุทูุฉ ุงูุฒูููุฉ ูู ุงูููุฏ:
```javascript
{
  timezone: "Asia/Riyadh" // Saudi Arabia timezone
}
```

---

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### ูููุงุช ุฌุฏูุฏุฉ:
- โ `utils/aiScheduler.js` - ูุธุงู ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ
- โ `AI_SCHEDULER_README.md` - ูุฐุง ุงูููู

### ูููุงุช ูุนุฏูุฉ:
- โ `server.js` - ุฅุถุงูุฉ ุงุณุชุฏุนุงุก ุงูุฌุฏููุฉ ุนูุฏ ุจุฏุก ุงูุฎุงุฏู
- โ `utils/aiService.js` - ุชุญุณูู ูุดุฑ ุตูุฑ ุงูุฃุณุทูู
- โ `package.json` - ุฅุถุงูุฉ ุญุฒูุฉ `node-cron`

---

## ๐ฏ ุงูููุฒุงุช ุงูุฅุถุงููุฉ

### ุชุดุบูู ูุฏูู ููุฑู (ููุงุฎุชุจุงุฑ):

ุฅุฐุง ุฃุฑุฏุช ุชุดุบูู ุงูููุฒุงุช ููุฑุงู ุฏูู ุงูุชุธุงุฑ ุงูุฌุฏููุฉ:

1. ุงูุชุญ `utils/aiScheduler.js`
2. ุงุณุชุฎุฏู ุงูุฏุงูุฉ `runAIFeaturesNow()`
3. ุฃู ุงุณุชุฎุฏู endpoint ุงูููุฌูุฏ: `POST /api/v1/ai-features/run`

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงููุฑุงูุจุฉ

### ูุง ูุชู ุชุณุฌููู:
- โ ููุช ุจุฏุก ุงูุชุดุบูู
- โ ุนุฏุฏ ุงูุดุฑูุงุช ุงููุณุชูุฏูุฉ
- โ ูุชุงุฆุฌ ูู ููุฒุฉ
- โ ุนุฏุฏ ุงูููุดูุฑุงุช/ุงูุฑุณุงุฆู ุงููููุดุฃุฉ
- โ ุงูุฃุฎุทุงุก ูุงููุดุงูู
- โ ููุช ุงูุงูุชูุงุก

### ูุซุงู ุนูู ุงูุณุฌู:
```
๐ค [AI Scheduler] Starting daily AI features execution at 27/10/2025, 9:00:00 AM
๐ข Found 5 companies with AI features enabled
โถ๏ธ  Running AI features for: ุดุฑูุฉ ุงูููู ุงูุณุฑูุน (507f1f77bcf86cd799439011)
   โ Auto Posting: ุชู ุฅูุดุงุก 2 ููุดูุฑุงุช ุจูุฌุงุญ
   โ Fleet Promotion: ุชู ุฅูุดุงุก ููุดูุฑ ุชุฑููุฌู ุจูุฌุงุญ
โถ๏ธ  Running AI features for: ุดุฑูุฉ ุงูุดุญู ุงูุฏููู (507f1f77bcf86cd799439012)
   โ Auto Messaging: ุชู ุฅุฑุณุงู 3 ุฑุณุงุฆู ุจูุฌุงุญ
โ [AI Scheduler] Completed: 5 successful, 0 errors
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฐ ุงูุชูููุฉ ูุงูุชุญูู

### ุชูููู ุงูุชูููุฉ:
1. ูุนูู ุงูููุฒุงุช ุงูุชู ุชุญุชุงุฌูุง ููุท
2. ููู ุนุฏุฏ ูุฑุงุช ุงูุชุดุบูู ุงููููู
3. ุฑุงูุจ ุงุณุชููุงู DeepSeek API

### ุฅููุงู ุงูุฌุฏููุฉ ูุคูุชุงู:
ุนููู ุงูุณุทุฑ ูู `server.js`:
```javascript
// startAIScheduler(); // ูุนุทู ูุคูุชุงู
```

---

## ๐ ุงูุฃูุงู

- โ ุงูุฌุฏููุฉ ุชุนูู ููุท ููุดุฑูุงุช ุงูููุนูุฉ
- โ ูู ุดุฑูุฉ ุชุฑู ููุดูุฑุงุชูุง ูุฑุณุงุฆููุง ููุท
- โ ููุชุงุญ DeepSeek API ูุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
- โ ุงูุณุฌูุงุช ูุง ุชุญุชูู ุนูู ุจูุงูุงุช ุญุณุงุณุฉ

---

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงูู:
- ุฑุงุฌุน console logs ููุฃุฎุทุงุก
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุดุฑูุฉ
- ุชุฃูุฏ ูู ุตุญุฉ ููุชุงุญ DeepSeek API

---

**ุชู ุงูุชุทููุฑ ุจูุฌุงุญ! ๐**

ุงูุขู ูุฏูู ูุธุงู ุฐูุงุก ุงุตุทูุงุนู ูุงูู ูุนูู ุชููุงุฆูุงู ูู ููู!

