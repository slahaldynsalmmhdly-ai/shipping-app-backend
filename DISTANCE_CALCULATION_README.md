# ุฏููู ุญุณุงุจ ุงููุณุงูุฉ ุงูุชููุงุฆู ๐บ๏ธ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ููุฒุฉ ุญุณุงุจ ุงููุณุงูุฉ ุงูุชููุงุฆู ุจูู ุฃู ูุฏููุชูู ูู ุงูุนุงูู ุจุงุณุชุฎุฏุงู ุชูููุงุช ููุชูุญุฉ ุงููุตุฏุฑ ููุฌุงููุฉ 100%.

---

## ๐ ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ

### 1. **OSRM (Open Source Routing Machine)**
- **ุงููุธููุฉ**: ุญุณุงุจ ุงููุณุงูุฉ ุงููุนููุฉ ุนูู ุงูุทุฑู
- **ุงููุตุฏุฑ**: ููุชูุญ ุงููุตุฏุฑ ููุฌุงูู
- **ุงูุชุบุทูุฉ**: ุฌููุน ุฏูู ุงูุนุงูู
- **ุงูุฏูุฉ**: ุนุงููุฉ ุฌุฏุงู (ูุณุชุฎุฏู ุจูุงูุงุช OpenStreetMap)
- **API**: `http://router.project-osrm.org`

### 2. **Nominatim (OpenStreetMap Geocoding)**
- **ุงููุธููุฉ**: ุชุญููู ุฃุณูุงุก ุงููุฏู ุฅูู ุฅุญุฏุงุซูุงุช (Geocoding)
- **ุงููุตุฏุฑ**: ููุชูุญ ุงููุตุฏุฑ ููุฌุงูู
- **ุงูุชุบุทูุฉ**: ุฌููุน ุฏูู ุงูุนุงูู
- **ุงููุบุงุช**: ูุฏุนู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ ูุฌููุน ุงููุบุงุช

### 3. **Haversine Formula**
- **ุงููุธููุฉ**: ุญุณุงุจ ุงููุณุงูุฉ ุงููุจุงุดุฑุฉ (ูุจุฏูู ุงุญุชูุงุทู)
- **ุงูุงุณุชุฎุฏุงู**: ุนูุฏ ูุดู OSRM API

---

## ๐ API Endpoints

### 1. ุญุณุงุจ ุงููุณุงูุฉ ุจูู ูุฏููุชูู

```http
POST /api/v1/distance/calculate
Content-Type: application/json

{
  "from": "ุงูุฑูุงุถ",
  "to": "ุฌุฏุฉ"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "from": {
    "input": "ุงูุฑูุงุถ",
    "city": "ุงูุฑูุงุถ",
    "country": "ุงูุณุนูุฏูุฉ",
    "coordinates": {
      "lat": 23.333333,
      "lon": 45.333333
    },
    "formatted_address": "ููุทูุฉ ุงูุฑูุงุถ, ุงูุณุนูุฏูุฉ"
  },
  "to": {
    "input": "ุฌุฏุฉ",
    "city": "ุฌุฏุฉ",
    "country": "ุงูุณุนูุฏูุฉ",
    "coordinates": {
      "lat": 21.5504432,
      "lon": 39.1742363
    },
    "formatted_address": "ุฌุฏุฉ, ูุญุงูุธุฉ ุฌุฏุฉ, ููุทูุฉ ููุฉ ุงูููุฑูุฉ, ุงูุณุนูุฏูุฉ"
  },
  "distance": {
    "kilometers": 887,
    "meters": 887023.8,
    "method": "osrm_driving"
  },
  "duration": {
    "hours": 10.83,
    "minutes": 650
  },
  "calculated_at": "2025-11-07T19:32:22.417Z"
}
```

---

### 2. ุงุณุชุฎุฑุงุฌ ุงููุฏู ูู ูุต ูุญุณุงุจ ุงููุณุงูุฉ

```http
POST /api/v1/distance/extract-and-calculate
Content-Type: application/json

{
  "text": "ุฃุฑูุฏ ุดุญู ุจุถุงุฆุน ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "from": { ... },
  "to": { ... },
  "distance": {
    "kilometers": 887,
    "meters": 887023.8,
    "method": "osrm_driving"
  },
  "duration": {
    "hours": 10.83,
    "minutes": 650
  },
  "extracted_from_text": "ุฃุฑูุฏ ุดุญู ุจุถุงุฆุน ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ",
  "detected_pattern": "ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ"
}
```

---

### 3. ุญุณุงุจ ุงููุณุงูุฉ ูุงูุณุนุฑ ูุนุงู

```http
POST /api/v1/distance/calculate-with-pricing
Content-Type: application/json

{
  "from": "ุงูุฑูุงุถ",
  "to": "ุฌุฏุฉ",
  "cargoType": "ูุฑุงุชูู",
  "weightCategory": "medium"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "distance_info": {
    "from": { ... },
    "to": { ... },
    "distance": {
      "kilometers": 887
    },
    "duration": {
      "hours": 10.83,
      "minutes": 650
    }
  },
  "pricing": {
    "cargo_type": "ูุฑุงุชูู",
    "distance": 887,
    "base_price": 4435.00,
    "subtotal": 5765.50,
    "discount_percentage": 20.00,
    "discount_amount": 1153.10,
    "final_price": 4612.40,
    "currency": "ุฑูุงู ุณุนูุฏู"
  },
  "summary": {
    "route": "ุงูุฑูุงุถ โ ุฌุฏุฉ",
    "distance_km": 887,
    "estimated_duration": "10.83 ุณุงุนุฉ",
    "cargo_type": "ูุฑุงุชูู",
    "final_price": 4612.40,
    "currency": "ุฑูุงู ุณุนูุฏู",
    "discount_applied": true
  }
}
```

---

### 4. ุงุณุชุนูุงู ุฐูู (ููุฐูุงุก ุงูุงุตุทูุงุนู)

```http
POST /api/v1/distance/smart-query
Content-Type: application/json

{
  "query": "ุฃุฑูุฏ ุดุญู ูุฑุงุชูู ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ",
  "cargoType": "ูุฑุงุชูู",
  "weightCategory": "medium"
}
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "original_query": "ุฃุฑูุฏ ุดุญู ูุฑุงุชูู ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ",
  "understanding": {
    "from_city": "ุงูุฑูุงุถ",
    "to_city": "ุฌุฏุฉ",
    "cargo_type": "ูุฑุงุชูู"
  },
  "distance": {
    "kilometers": 887,
    "estimated_duration": "10.83 ุณุงุนุฉ (650 ุฏูููุฉ)"
  },
  "pricing": {
    "base_price": 4435.00,
    "final_price": 4612.40,
    "currency": "ุฑูุงู ุณุนูุฏู",
    "discount_percentage": 20.00,
    "discount_amount": 1153.10
  },
  "discount_info": {
    "eligible": true,
    "current_discount": "20%",
    "message": "ุชู ุชุทุจูู ุฎุตู 20% ุนูู ูุฐู ุงูุฑุญูุฉ!"
  },
  "ai_response": "ุชู ุญุณุงุจ ุงููุณุงูุฉ ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ:\n\n๐ ุงููุณุงูุฉ: 887 ูููููุชุฑ\nโฑ๏ธ ุงูููุช ุงููุชููุน: 10.83 ุณุงุนุฉ\n๐ฆ ููุน ุงูุญูููุฉ: ูุฑุงุชูู\n\n๐ฐ ุงูุณุนุฑ ุงูุฃุณุงุณู: 5765.5 ุฑูุงู ุณุนูุฏู\n๐ ุงูุฎุตู (20%): -1153.1 ุฑูุงู ุณุนูุฏู\nโ ุงูุณุนุฑ ุงูููุงุฆู: 4612.4 ุฑูุงู ุณุนูุฏู\n\nุชูุงูููุง! ุญุตูุช ุนูู ุฎุตู 20% ุนูู ูุฐู ุงูุฑุญูุฉ! ๐"
}
```

---

## ๐ค ุฏูุฌ ูุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู

### ููู ูุนููุ

ุนูุฏูุง ููุชุจ ุงููุณุชุฎุฏู ูู ุงูุฏุฑุฏุดุฉ:
```
"ุฃุฑูุฏ ุดุญู ุจุถุงุฆุน ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ"
```

ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูููู ุจู:
1. **ุงุณุชุฎุฑุงุฌ ุงููุฏู** ูู ุงููุต
2. **ุญุณุงุจ ุงููุณุงูุฉ** ุชููุงุฆูุงู
3. **ุญุณุงุจ ุงูุณุนุฑ** ุจูุงุกู ุนูู ุงููุณุงูุฉ
4. **ุชุญุฏูุฏ ุงูุฎุตู** ุฅู ูุฌุฏ
5. **ุงูุฑุฏ ุนูู ุงููุณุชุฎุฏู** ุจุฑุณุงูุฉ ูุงุถุญุฉ

### ูุซุงู ุนูู ุงูุฑุฏ:

```
ุชู ุญุณุงุจ ุงููุณุงูุฉ ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ:

๐ ุงููุณุงูุฉ: 887 ูููููุชุฑ
โฑ๏ธ ุงูููุช ุงููุชููุน: 10.83 ุณุงุนุฉ
๐ฆ ููุน ุงูุญูููุฉ: ูุฑุงุชูู

๐ฐ ุงูุณุนุฑ ุงูุฃุณุงุณู: 5765.5 ุฑูุงู ุณุนูุฏู
๐ ุงูุฎุตู (20%): -1153.1 ุฑูุงู ุณุนูุฏู
โ ุงูุณุนุฑ ุงูููุงุฆู: 4612.4 ุฑูุงู ุณุนูุฏู

ุชูุงูููุง! ุญุตูุช ุนูู ุฎุตู 20% ุนูู ูุฐู ุงูุฑุญูุฉ! ๐
```

---

## ๐ ุฃูุซูุฉ ุนุงูููุฉ

### ูุซุงู 1: ูุฏู ุนุฑุจูุฉ
```json
{
  "from": "ุงููุงูุฑุฉ",
  "to": "ุฏุจู"
}
```

### ูุซุงู 2: ูุฏู ุฅูุฌููุฒูุฉ
```json
{
  "from": "London",
  "to": "Paris"
}
```

### ูุซุงู 3: ูุฏู ูุฎุชูุทุฉ
```json
{
  "from": "ุงูุฑูุงุถ",
  "to": "Dubai"
}
```

### ูุซุงู 4: ูุฏู ุจุนูุฏุฉ
```json
{
  "from": "New York",
  "to": "Los Angeles"
}
```

---

## ๐ ุงูุฃููุงุท ุงููุฏุนููุฉ

### ุฃููุงุท ุนุฑุจูุฉ:
- "ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ"
- "ูู ุงูุฑูุงุถ ุงูู ุฌุฏุฉ"
- "ูู ุงูุฑูุงุถ ูู ุฌุฏุฉ"
- "ูู ุงูุฑูุงุถ ู ุฌุฏุฉ"
- "ุดุญู ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉ"

### ุฃููุงุท ุฅูุฌููุฒูุฉ:
- "from Riyadh to Jeddah"
- "shipping from Riyadh to Jeddah"
- "from London to Paris"

---

## โ๏ธ ููููุฉ ุงูุงุณุชุฎุฏุงู ูู ุงูููุฏ

### JavaScript/Node.js

```javascript
const axios = require('axios');

// ุญุณุงุจ ุงููุณุงูุฉ
async function calculateDistance(from, to) {
  const response = await axios.post('http://localhost:5000/api/v1/distance/calculate', {
    from: from,
    to: to
  });
  
  return response.data;
}

// ุงุณุชุฎุฏุงู
calculateDistance('ุงูุฑูุงุถ', 'ุฌุฏุฉ')
  .then(result => {
    console.log(`ุงููุณุงูุฉ: ${result.distance.kilometers} ูู`);
    console.log(`ุงูููุช: ${result.duration.hours} ุณุงุนุฉ`);
  });
```

### Python

```python
import requests

def calculate_distance(from_city, to_city):
    url = 'http://localhost:5000/api/v1/distance/calculate'
    data = {
        'from': from_city,
        'to': to_city
    }
    
    response = requests.post(url, json=data)
    return response.json()

# ุงุณุชุฎุฏุงู
result = calculate_distance('ุงูุฑูุงุถ', 'ุฌุฏุฉ')
print(f"ุงููุณุงูุฉ: {result['distance']['kilometers']} ูู")
```

---

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ุฎุงุฏู OSRM

ูู ููู `services/distanceService.js`:

```javascript
// ุงุณุชุฎุฏุงู ุฎุงุฏู OSRM ุฎุงุต ุจู
const osrmUrl = `http://your-osrm-server.com/route/v1/driving/${lon1},${lat1};${lon2},${lat2}`;
```

### ุฅุถุงูุฉ ุฃููุงุท ุฌุฏูุฏุฉ ููุงุณุชุฎุฑุงุฌ

ูู ููู `services/distanceService.js`:

```javascript
const arabicPatterns = [
  /ูู\s+([^\s]+(?:\s+[^\s]+)?)\s+(?:ุฅูู|ุงูู|ูู|ู)\s+([^\s]+(?:\s+[^\s]+)?)/i,
  // ุฃุถู ููุทู ุงูุฌุฏูุฏ ููุง
];
```

---

## ๐จ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ุฎุทุฃ: "ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุฏููุฉ"

```json
{
  "success": false,
  "message": "ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุฏููุฉ: xyz"
}
```

**ุงูุญู**: ุชุฃูุฏ ูู ูุชุงุจุฉ ุงุณู ุงููุฏููุฉ ุจุดูู ุตุญูุญ.

### ุฎุทุฃ: "ูุดู ูู ุญุณุงุจ ุงููุณุงุฑ"

```json
{
  "success": false,
  "message": "ูุดู ูู ุญุณุงุจ ุงููุณุงุฑ"
}
```

**ุงูุญู**: ุงููุธุงู ุณูุณุชุฎุฏู ุชููุงุฆูุงู ุญุณุงุจ ุงููุณุงูุฉ ุงููุจุงุดุฑุฉ (Haversine) ูุจุฏูู.

---

## ๐ ุงูุฃุฏุงุก

- **Geocoding**: 1-2 ุซุงููุฉ ููู ูุฏููุฉ
- **ุญุณุงุจ ุงููุณุงูุฉ (OSRM)**: 0.5-1 ุซุงููุฉ
- **ุญุณุงุจ ุงููุณุงูุฉ (Haversine)**: < 0.1 ุซุงููุฉ
- **ุฅุฌูุงูู ุงูููุช**: 2-4 ุซูุงูู

---

## ๐ก ูุตุงุฆุญ

1. **ุงุณุชุฎุฏู ุฃุณูุงุก ุงููุฏู ุงูุดููุฑุฉ**: "ุงูุฑูุงุถ" ุฃูุถู ูู "ุญู ุงููุฎูู"
2. **ุชุฌูุจ ุงูุงุฎุชุตุงุฑุงุช**: "ุงูุฑูุงุถ" ุฃูุถู ูู "ุฑ.ุถ"
3. **ุงุณุชุฎุฏู ุงููุบุฉ ุงูุนุฑุจูุฉ ุฃู ุงูุฅูุฌููุฒูุฉ**: ููุงููุง ูุฏุนูู
4. **ูููุฏู ุงูุตุบูุฑุฉ**: ุฃุถู ุงุณู ุงูุจูุฏ ููุฏูุฉ (ูุซู: "ุงูุฎุฑุฌุ ุงูุณุนูุฏูุฉ")

---

## ๐ฏ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1. ุงูุฏุฑุฏุดุฉ ูุน ุงูุนููุงุก
```
ุงูุนููู: "ูู ุณุนุฑ ุงูุดุญู ูู ุงูุฑูุงุถ ุฅูู ุฌุฏุฉุ"
ุงูุจูุช: ูุญุณุจ ุงููุณุงูุฉ ุชููุงุฆูุงู ููุนุทู ุงูุณุนุฑ
```

### 2. ุญุงุณุจุฉ ุงูุฃุณุนุงุฑ
```
ุงููุณุชุฎุฏู ูุฏุฎู: ูู + ุฅูู
ุงููุธุงู ูุญุณุจ: ุงููุณุงูุฉ + ุงูุณุนุฑ + ุงูุฎุตู
```

### 3. ุชูุฏูุฑ ุงูููุช
```
ุงููุณุชุฎุฏู: "ูู ูุณุชุบุฑู ุงูุดุญูุ"
ุงููุธุงู: "10.83 ุณุงุนุฉ ุชูุฑูุจุงู"
```

---

## ๐ ุงูุฃูุงู ูุงูุฎุตูุตูุฉ

โ **ูุง ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช**: ุฌููุน ุงูุญุณุงุจุงุช ูุคูุชุฉ  
โ **APIs ูุฌุงููุฉ**: ูุง ุชูุงููู ุฎููุฉ  
โ **ููุชูุญ ุงููุตุฏุฑ**: ูููู ูุฑุงุฌุนุฉ ุงูููุฏ  
โ **ูุง ุชุชุจุน**: ูุง ูุชู ุชุชุจุน ุงููุณุชุฎุฏููู  

---

## ๐ ุงููุฑุงุฌุน

- [OSRM Documentation](http://project-osrm.org/)
- [Nominatim API](https://nominatim.org/release-docs/latest/api/Overview/)
- [OpenStreetMap](https://www.openstreetmap.org/)
- [Haversine Formula](https://en.wikipedia.org/wiki/Haversine_formula)

---

## ๐ ุงูุฎูุงุตุฉ

ุงูุขู ูุฏูู ูุธุงู ูุงูู ูุญุณุงุจ ุงููุณุงูุฉ ุจูู ุฃู ูุฏููุชูู ูู ุงูุนุงููุ ูุฌุงูุงู ูุจุฏูุฉ ุนุงููุฉ! ๐โจ
